{"ast":null,"code":"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : factory(global.ElasticAppSearch = {});\n})(this, function (exports) {\n  'use strict';\n\n  var classCallCheck = function classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  var createClass = function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  }();\n\n  var defineProperty = function defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  };\n\n  var _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  var objectWithoutProperties = function objectWithoutProperties(obj, keys) {\n    var target = {};\n\n    for (var i in obj) {\n      if (keys.indexOf(i) >= 0) continue;\n      if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n      target[i] = obj[i];\n    }\n\n    return target;\n  };\n\n  var slicedToArray = function () {\n    function sliceIterator(arr, i) {\n      var _arr = [];\n      var _n = true;\n      var _d = false;\n      var _e = undefined;\n\n      try {\n        for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n          _arr.push(_s.value);\n\n          if (i && _arr.length === i) break;\n        }\n      } catch (err) {\n        _d = true;\n        _e = err;\n      } finally {\n        try {\n          if (!_n && _i[\"return\"]) _i[\"return\"]();\n        } finally {\n          if (_d) throw _e;\n        }\n      }\n\n      return _arr;\n    }\n\n    return function (arr, i) {\n      if (Array.isArray(arr)) {\n        return arr;\n      } else if (Symbol.iterator in Object(arr)) {\n        return sliceIterator(arr, i);\n      } else {\n        throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n      }\n    };\n  }();\n\n  var toArray = function toArray(arr) {\n    return Array.isArray(arr) ? arr : Array.from(arr);\n  };\n\n  var toConsumableArray = function toConsumableArray(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n        arr2[i] = arr[i];\n      }\n\n      return arr2;\n    } else {\n      return Array.from(arr);\n    }\n  };\n  /**\n   * An individual search result\n   */\n\n\n  var ResultItem = function () {\n    function ResultItem(data) {\n      classCallCheck(this, ResultItem);\n\n      if (data._group && data._group.length > 0) {\n        data = _extends({}, data, {\n          _group: data._group.map(function (nestedData) {\n            return new ResultItem(nestedData);\n          })\n        });\n      }\n\n      this.data = data;\n    }\n    /**\n     * Return the HTML-unsafe raw value for a field, if it exists\n     *\n     * @param {String} key - name of the field\n     *\n     * @returns {any} the raw value of the field\n     */\n\n\n    createClass(ResultItem, [{\n      key: \"getRaw\",\n      value: function getRaw(key) {\n        return (this.data[key] || {}).raw;\n      }\n      /**\n       * Return the HTML-safe snippet value for a field, if it exists\n       *\n       * @param {String} key - name of the field\n       *\n       * @returns {any} the snippet value of the field\n       */\n\n    }, {\n      key: \"getSnippet\",\n      value: function getSnippet(key) {\n        return (this.data[key] || {}).snippet;\n      }\n    }]);\n    return ResultItem;\n  }();\n  /**\n   * A list of ResultItems and additional information returned by a search request\n   */\n\n\n  var ResultList = function ResultList(rawResults, rawInfo) {\n    classCallCheck(this, ResultList);\n    this.rawResults = rawResults;\n    this.rawInfo = rawInfo;\n    var results = new Array();\n    rawResults.forEach(function (data) {\n      results.push(new ResultItem(data));\n    });\n    this.results = results;\n    this.info = rawInfo;\n  };\n  /**\n   * A helper for working with the JSON structure which represent\n   * filters in API requests.\n   */\n\n\n  var Filters = function () {\n    function Filters() {\n      var filtersJSON = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      classCallCheck(this, Filters);\n      this.filtersJSON = filtersJSON;\n    }\n\n    createClass(Filters, [{\n      key: \"removeFilter\",\n      value: function removeFilter(filterKey) {\n        var filtersMap = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.filtersJSON;\n\n        function go(filterKey, filtersMap) {\n          var filtered = Object.entries(filtersMap).reduce(function (acc, _ref) {\n            var _ref2 = slicedToArray(_ref, 2),\n                filterName = _ref2[0],\n                filterValue = _ref2[1];\n\n            if (filterName === filterKey) {\n              return acc;\n            }\n\n            if ([\"all\", \"any\", \"none\"].includes(filterName)) {\n              var nestedFiltersArray = filterValue;\n              filterValue = nestedFiltersArray.reduce(function (acc, nestedFiltersMap) {\n                var updatedNestedFiltersMap = go(filterKey, nestedFiltersMap);\n\n                if (updatedNestedFiltersMap) {\n                  return acc.concat(updatedNestedFiltersMap);\n                } else {\n                  return acc;\n                }\n              }, []);\n            }\n\n            return _extends({}, acc, defineProperty({}, filterName, filterValue));\n          }, {});\n\n          if (Object.keys(filtered).length === 0) {\n            return;\n          }\n\n          return filtered;\n        }\n\n        var filtered = go(filterKey, filtersMap);\n        return new Filters(filtered);\n      }\n    }, {\n      key: \"getListOfAppliedFilters\",\n      value: function getListOfAppliedFilters() {\n        var _this = this;\n\n        var filters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.filtersJSON;\n        var set$$1 = Object.entries(filters).reduce(function (acc, _ref3) {\n          var _ref4 = slicedToArray(_ref3, 2),\n              key = _ref4[0],\n              value = _ref4[1];\n\n          if (![\"all\", \"any\", \"none\"].includes(key)) {\n            acc.add(key);\n          } else {\n            value.forEach(function (nestedValue) {\n              Object.keys(nestedValue).forEach(function (nestedKey) {\n                if (![\"all\", \"any\", \"none\"].includes(nestedKey)) {\n                  acc.add(nestedKey);\n                } else {\n                  acc = new Set([].concat(toConsumableArray(acc), toConsumableArray(_this.getListOfAppliedFilters(nestedValue))));\n                }\n              });\n            });\n          }\n\n          return acc;\n        }, new Set());\n        return Array.from(set$$1.values());\n      }\n    }]);\n    return Filters;\n  }();\n\n  var version = \"7.7.0\";\n\n  var QueryCache = function () {\n    function QueryCache() {\n      classCallCheck(this, QueryCache);\n      this.cache = {};\n    }\n\n    createClass(QueryCache, [{\n      key: \"getKey\",\n      value: function getKey(method, url, params) {\n        return method + url + JSON.stringify(params);\n      }\n    }, {\n      key: \"store\",\n      value: function store(key, response) {\n        this.cache[key] = response;\n      }\n    }, {\n      key: \"retrieve\",\n      value: function retrieve(key) {\n        return this.cache[key];\n      }\n    }]);\n    return QueryCache;\n  }();\n\n  var cache = new QueryCache();\n\n  function request(searchKey, apiEndpoint, path, params, cacheResponses) {\n    var _ref = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {},\n        additionalHeaders = _ref.additionalHeaders;\n\n    var method = \"POST\";\n    var key = cache.getKey(method, apiEndpoint + path, params);\n\n    if (cacheResponses) {\n      var cachedResult = cache.retrieve(key);\n\n      if (cachedResult) {\n        return Promise.resolve(cachedResult);\n      }\n    }\n\n    return _request(method, searchKey, apiEndpoint, path, params, {\n      additionalHeaders: additionalHeaders\n    }).then(function (response) {\n      return response.json().then(function (json) {\n        var result = {\n          response: response,\n          json: json\n        };\n        if (cacheResponses) cache.store(key, result);\n        return result;\n      }).catch(function () {\n        return {\n          response: response,\n          json: {}\n        };\n      });\n    });\n  }\n\n  function _request(method, searchKey, apiEndpoint, path, params) {\n    var _ref2 = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {},\n        additionalHeaders = _ref2.additionalHeaders;\n\n    var headers = new Headers(_extends({\n      Authorization: \"Bearer \" + searchKey,\n      \"Content-Type\": \"application/json\",\n      \"X-Swiftype-Client\": \"elastic-app-search-javascript\",\n      \"X-Swiftype-Client-Version\": version\n    }, additionalHeaders));\n    return fetch(\"\" + apiEndpoint + path, {\n      method: method,\n      headers: headers,\n      body: JSON.stringify(params),\n      credentials: \"include\"\n    });\n  }\n\n  var SEARCH_TYPES = {\n    SEARCH: \"SEARCH\",\n    MULTI_SEARCH: \"MULTI_SEARCH\"\n  };\n  /**\n   * Omit a single key from an object\n   */\n\n  function omit(obj, keyToOmit) {\n    if (!obj) return;\n    var _ = obj[keyToOmit],\n        rest = objectWithoutProperties(obj, [keyToOmit]);\n    return rest;\n  }\n\n  function flatten(arrayOfArrays) {\n    return [].concat.apply([], arrayOfArrays);\n  }\n\n  function formatResultsJSON(json) {\n    return new ResultList(json.results, omit(json, \"results\"));\n  }\n\n  function handleErrorResponse(_ref) {\n    var response = _ref.response,\n        json = _ref.json;\n\n    if (!response.ok) {\n      var message = Array.isArray(json) ? \" \" + flatten(json.map(function (response) {\n        return response.errors;\n      })).join(\", \") : \"\" + (json.errors ? \" \" + json.errors : \"\");\n      throw new Error(\"[\" + response.status + \"]\" + message);\n    }\n\n    return json;\n  }\n\n  var Client = function () {\n    function Client(hostIdentifier, searchKey, engineName) {\n      var _ref2 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {},\n          _ref2$endpointBase = _ref2.endpointBase,\n          endpointBase = _ref2$endpointBase === undefined ? \"\" : _ref2$endpointBase,\n          _ref2$cacheResponses = _ref2.cacheResponses,\n          cacheResponses = _ref2$cacheResponses === undefined ? true : _ref2$cacheResponses,\n          additionalHeaders = _ref2.additionalHeaders;\n\n      classCallCheck(this, Client);\n      this.additionalHeaders = additionalHeaders;\n      this.searchKey = searchKey;\n      this.cacheResponses = cacheResponses;\n      this.engineName = engineName;\n      this.apiEndpoint = endpointBase ? endpointBase + \"/api/as/v1/\" : \"https://\" + hostIdentifier + \".api.swiftype.com/api/as/v1/\";\n      this.searchPath = \"engines/\" + this.engineName + \"/search\";\n      this.multiSearchPath = \"engines/\" + this.engineName + \"/multi_search\";\n      this.querySuggestionPath = \"engines/\" + this.engineName + \"/query_suggestion\";\n      this.clickPath = \"engines/\" + this.engineName + \"/click\";\n    }\n    /**\n     * Sends a query suggestion request to the Elastic App Search Api\n     *\n     * @param {String} query String that is used to perform a query suggest.\n     * @param {Object} options Object used for configuring the query suggest, like 'types' or 'size'\n     * @returns {Promise<ResultList>} a Promise that returns results, otherwise throws an Error.\n     */\n\n\n    createClass(Client, [{\n      key: \"querySuggestion\",\n      value: function querySuggestion(query) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var params = Object.assign({\n          query: query\n        }, options);\n        return request(this.searchKey, this.apiEndpoint, this.querySuggestionPath, params, this.cacheResponses, {\n          additionalHeaders: this.additionalHeaders\n        }).then(handleErrorResponse);\n      }\n      /**\n       * Sends a search request to the Elastic App Search Api\n       *\n       * @param {String} query String, Query, or Object that is used to perform a search request.\n       * @param {Object} options Object used for configuring the search like search_fields and result_fields\n       * @returns {Promise<ResultList>} a Promise that returns a {ResultList} when resolved, otherwise throws an Error.\n       */\n\n    }, {\n      key: \"search\",\n      value: function search(query) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var disjunctiveFacets = options.disjunctiveFacets,\n            disjunctiveFacetsAnalyticsTags = options.disjunctiveFacetsAnalyticsTags,\n            validOptions = objectWithoutProperties(options, [\"disjunctiveFacets\", \"disjunctiveFacetsAnalyticsTags\"]);\n        var params = Object.assign({\n          query: query\n        }, validOptions);\n\n        if (disjunctiveFacets && disjunctiveFacets.length > 0) {\n          return this._performDisjunctiveSearch(params, disjunctiveFacets, disjunctiveFacetsAnalyticsTags).then(formatResultsJSON);\n        }\n\n        return this._performSearch(params).then(formatResultsJSON);\n      }\n      /**\n       * Sends multiple search requests to the Elastic App Search Api, using the\n       * \"multi_search\" endpoint\n       *\n       * @param {Array[Object]} searches searches to send, valid keys are:\n       * - query: String\n       * - options: Object (optional)\n       * @returns {Promise<[ResultList]>} a Promise that returns an array of {ResultList} when resolved, otherwise throws an Error.\n       */\n\n    }, {\n      key: \"multiSearch\",\n      value: function multiSearch(searches) {\n        var params = searches.map(function (search) {\n          return _extends({\n            query: search.query\n          }, search.options || {});\n        });\n        return this._performSearch({\n          queries: params\n        }, SEARCH_TYPES.MULTI_SEARCH).then(function (responses) {\n          return responses.map(formatResultsJSON);\n        });\n      }\n      /*\n       * A disjunctive search, as opposed to a regular search is used any time\n       * a `disjunctiveFacet` option is provided to the `search` method. A\n       * a disjunctive facet requires multiple API calls.\n       *\n       * Typically:\n       *\n       * 1 API call to get the base results\n       * 1 additional API call to get the \"disjunctive\" facet counts for each\n       * facet configured as \"disjunctive\".\n       *\n       * The additional API calls are required, because a \"disjunctive\" facet\n       * is one where we want the counts for a facet as if there is no filter applied\n       * to a particular field.\n       *\n       * After all queries are performed, we merge the facet values on the\n       * additional requests into the facet values of the original request, thus\n       * creating a single response with the disjunctive facet values.\n       */\n\n    }, {\n      key: \"_performDisjunctiveSearch\",\n      value: function _performDisjunctiveSearch(params, disjunctiveFacets) {\n        var _this = this;\n\n        var disjunctiveFacetsAnalyticsTags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [\"Facet-Only\"];\n\n        var baseQueryPromise = this._performSearch(params);\n\n        var filters = new Filters(params.filters);\n        var appliedFilers = filters.getListOfAppliedFilters();\n        var listOfAppliedDisjunctiveFilters = appliedFilers.filter(function (filter) {\n          return disjunctiveFacets.includes(filter);\n        });\n\n        if (!listOfAppliedDisjunctiveFilters.length) {\n          return baseQueryPromise;\n        }\n\n        var page = params.page || {}; // We intentionally drop passed analytics tags here so that we don't get\n        // double counted search analytics in the dashboard from disjunctive\n        // calls\n\n        var analytics = params.analytics || {};\n        analytics.tags = disjunctiveFacetsAnalyticsTags;\n        var disjunctiveQueriesPromises = listOfAppliedDisjunctiveFilters.map(function (appliedDisjunctiveFilter) {\n          return _this._performSearch(_extends({}, params, {\n            filters: filters.removeFilter(appliedDisjunctiveFilter).filtersJSON,\n            page: _extends({}, page, {\n              // Set this to 0 for performance, since disjunctive queries\n              // don't need results\n              size: 0\n            }),\n            analytics: analytics,\n            facets: defineProperty({}, appliedDisjunctiveFilter, params.facets[appliedDisjunctiveFilter])\n          }));\n        });\n        return Promise.all([baseQueryPromise].concat(toConsumableArray(disjunctiveQueriesPromises))).then(function (_ref3) {\n          var _ref4 = toArray(_ref3),\n              baseQueryResults = _ref4[0],\n              disjunctiveQueries = _ref4.slice(1);\n\n          disjunctiveQueries.forEach(function (disjunctiveQueryResults) {\n            var _Object$entries$ = slicedToArray(Object.entries(disjunctiveQueryResults.facets)[0], 2),\n                facetName = _Object$entries$[0],\n                facetValue = _Object$entries$[1];\n\n            baseQueryResults.facets[facetName] = facetValue;\n          });\n          return baseQueryResults;\n        });\n      }\n    }, {\n      key: \"_performSearch\",\n      value: function _performSearch(params) {\n        var searchType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : SEARCH_TYPES.SEARCH;\n        var searchPath = searchType === SEARCH_TYPES.MULTI_SEARCH ? this.multiSearchPath : this.searchPath;\n        return request(this.searchKey, this.apiEndpoint, searchPath + \".json\", params, this.cacheResponses, {\n          additionalHeaders: this.additionalHeaders\n        }).then(handleErrorResponse);\n      }\n      /**\n       * Sends a click event to the Elastic App Search Api, to track a click-through event\n       *\n       * @param {String} query Query that was used to perform the search request\n       * @param {String} documentId ID of the document that was clicked\n       * @param {String} requestId Request_id from search response\n       * @param {String[]} tags Tags to categorize this request in the Dashboard\n       * @returns {Promise} An empty Promise, otherwise throws an Error.\n       */\n\n    }, {\n      key: \"click\",\n      value: function click(_ref5) {\n        var query = _ref5.query,\n            documentId = _ref5.documentId,\n            requestId = _ref5.requestId,\n            _ref5$tags = _ref5.tags,\n            tags = _ref5$tags === undefined ? [] : _ref5$tags;\n        var params = {\n          query: query,\n          document_id: documentId,\n          request_id: requestId,\n          tags: tags\n        };\n        return request(this.searchKey, this.apiEndpoint, this.clickPath + \".json\", params, this.cacheResponses, {\n          additionalHeaders: this.additionalHeaders\n        }).then(handleErrorResponse);\n      }\n    }]);\n    return Client;\n  }();\n\n  function createClient(_ref) {\n    var hostIdentifier = _ref.hostIdentifier,\n        accountHostKey = _ref.accountHostKey,\n        apiKey = _ref.apiKey,\n        searchKey = _ref.searchKey,\n        engineName = _ref.engineName,\n        endpointBase = _ref.endpointBase,\n        cacheResponses = _ref.cacheResponses,\n        additionalHeaders = _ref.additionalHeaders;\n    hostIdentifier = hostIdentifier || accountHostKey; // accountHostKey is deprecated\n\n    searchKey = searchKey || apiKey; //apiKey is deprecated\n\n    return new Client(hostIdentifier, searchKey, engineName, {\n      endpointBase: endpointBase,\n      cacheResponses: cacheResponses,\n      additionalHeaders: additionalHeaders\n    });\n  }\n\n  exports.createClient = createClient;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"sources":["/Users/pascalchristen/Documents/Development/searchzone-website/node_modules/@elastic/app-search-javascript/dist/elastic_app_search.umd.js"],"names":["global","factory","exports","module","define","amd","ElasticAppSearch","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","obj","value","_extends","assign","arguments","source","hasOwnProperty","call","objectWithoutProperties","keys","indexOf","slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","push","err","Array","isArray","toArray","from","toConsumableArray","arr2","ResultItem","data","_group","map","nestedData","getRaw","raw","getSnippet","snippet","ResultList","rawResults","rawInfo","results","forEach","info","Filters","filtersJSON","removeFilter","filterKey","filtersMap","go","filtered","entries","reduce","acc","_ref","_ref2","filterName","filterValue","includes","nestedFiltersArray","nestedFiltersMap","updatedNestedFiltersMap","concat","getListOfAppliedFilters","_this","filters","set$$1","_ref3","_ref4","add","nestedValue","nestedKey","Set","values","version","QueryCache","cache","getKey","method","url","params","JSON","stringify","store","response","retrieve","request","searchKey","apiEndpoint","path","cacheResponses","additionalHeaders","cachedResult","Promise","resolve","_request","then","json","result","catch","headers","Headers","Authorization","fetch","body","credentials","SEARCH_TYPES","SEARCH","MULTI_SEARCH","omit","keyToOmit","_","rest","flatten","arrayOfArrays","apply","formatResultsJSON","handleErrorResponse","ok","message","errors","join","Error","status","Client","hostIdentifier","engineName","_ref2$endpointBase","endpointBase","_ref2$cacheResponses","searchPath","multiSearchPath","querySuggestionPath","clickPath","querySuggestion","query","options","search","disjunctiveFacets","disjunctiveFacetsAnalyticsTags","validOptions","_performDisjunctiveSearch","_performSearch","multiSearch","searches","queries","responses","baseQueryPromise","appliedFilers","listOfAppliedDisjunctiveFilters","filter","page","analytics","tags","disjunctiveQueriesPromises","appliedDisjunctiveFilter","size","facets","all","baseQueryResults","disjunctiveQueries","slice","disjunctiveQueryResults","_Object$entries$","facetName","facetValue","searchType","click","_ref5","documentId","requestId","_ref5$tags","document_id","request_id","createClient","accountHostKey","apiKey"],"mappings":"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","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (factory((global.ElasticAppSearch = {})));\n}(this, (function (exports) { 'use strict';\n\n  var classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  var createClass = function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  }();\n\n  var defineProperty = function (obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  };\n\n  var _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  var objectWithoutProperties = function (obj, keys) {\n    var target = {};\n\n    for (var i in obj) {\n      if (keys.indexOf(i) >= 0) continue;\n      if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n      target[i] = obj[i];\n    }\n\n    return target;\n  };\n\n  var slicedToArray = function () {\n    function sliceIterator(arr, i) {\n      var _arr = [];\n      var _n = true;\n      var _d = false;\n      var _e = undefined;\n\n      try {\n        for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n          _arr.push(_s.value);\n\n          if (i && _arr.length === i) break;\n        }\n      } catch (err) {\n        _d = true;\n        _e = err;\n      } finally {\n        try {\n          if (!_n && _i[\"return\"]) _i[\"return\"]();\n        } finally {\n          if (_d) throw _e;\n        }\n      }\n\n      return _arr;\n    }\n\n    return function (arr, i) {\n      if (Array.isArray(arr)) {\n        return arr;\n      } else if (Symbol.iterator in Object(arr)) {\n        return sliceIterator(arr, i);\n      } else {\n        throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n      }\n    };\n  }();\n\n  var toArray = function (arr) {\n    return Array.isArray(arr) ? arr : Array.from(arr);\n  };\n\n  var toConsumableArray = function (arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    } else {\n      return Array.from(arr);\n    }\n  };\n\n  /**\n   * An individual search result\n   */\n\n  var ResultItem = function () {\n    function ResultItem(data) {\n      classCallCheck(this, ResultItem);\n\n      if (data._group && data._group.length > 0) {\n        data = _extends({}, data, {\n          _group: data._group.map(function (nestedData) {\n            return new ResultItem(nestedData);\n          })\n        });\n      }\n      this.data = data;\n    }\n\n    /**\n     * Return the HTML-unsafe raw value for a field, if it exists\n     *\n     * @param {String} key - name of the field\n     *\n     * @returns {any} the raw value of the field\n     */\n\n\n    createClass(ResultItem, [{\n      key: \"getRaw\",\n      value: function getRaw(key) {\n        return (this.data[key] || {}).raw;\n      }\n\n      /**\n       * Return the HTML-safe snippet value for a field, if it exists\n       *\n       * @param {String} key - name of the field\n       *\n       * @returns {any} the snippet value of the field\n       */\n\n    }, {\n      key: \"getSnippet\",\n      value: function getSnippet(key) {\n        return (this.data[key] || {}).snippet;\n      }\n    }]);\n    return ResultItem;\n  }();\n\n  /**\n   * A list of ResultItems and additional information returned by a search request\n   */\n\n  var ResultList = function ResultList(rawResults, rawInfo) {\n    classCallCheck(this, ResultList);\n\n    this.rawResults = rawResults;\n    this.rawInfo = rawInfo;\n\n    var results = new Array();\n    rawResults.forEach(function (data) {\n      results.push(new ResultItem(data));\n    });\n\n    this.results = results;\n    this.info = rawInfo;\n  };\n\n  /**\n   * A helper for working with the JSON structure which represent\n   * filters in API requests.\n   */\n  var Filters = function () {\n    function Filters() {\n      var filtersJSON = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      classCallCheck(this, Filters);\n\n      this.filtersJSON = filtersJSON;\n    }\n\n    createClass(Filters, [{\n      key: \"removeFilter\",\n      value: function removeFilter(filterKey) {\n        var filtersMap = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.filtersJSON;\n\n        function go(filterKey, filtersMap) {\n          var filtered = Object.entries(filtersMap).reduce(function (acc, _ref) {\n            var _ref2 = slicedToArray(_ref, 2),\n                filterName = _ref2[0],\n                filterValue = _ref2[1];\n\n            if (filterName === filterKey) {\n              return acc;\n            }\n\n            if ([\"all\", \"any\", \"none\"].includes(filterName)) {\n              var nestedFiltersArray = filterValue;\n              filterValue = nestedFiltersArray.reduce(function (acc, nestedFiltersMap) {\n                var updatedNestedFiltersMap = go(filterKey, nestedFiltersMap);\n                if (updatedNestedFiltersMap) {\n                  return acc.concat(updatedNestedFiltersMap);\n                } else {\n                  return acc;\n                }\n              }, []);\n            }\n\n            return _extends({}, acc, defineProperty({}, filterName, filterValue));\n          }, {});\n\n          if (Object.keys(filtered).length === 0) {\n            return;\n          }\n          return filtered;\n        }\n\n        var filtered = go(filterKey, filtersMap);\n        return new Filters(filtered);\n      }\n    }, {\n      key: \"getListOfAppliedFilters\",\n      value: function getListOfAppliedFilters() {\n        var _this = this;\n\n        var filters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.filtersJSON;\n\n        var set$$1 = Object.entries(filters).reduce(function (acc, _ref3) {\n          var _ref4 = slicedToArray(_ref3, 2),\n              key = _ref4[0],\n              value = _ref4[1];\n\n          if (![\"all\", \"any\", \"none\"].includes(key)) {\n            acc.add(key);\n          } else {\n            value.forEach(function (nestedValue) {\n              Object.keys(nestedValue).forEach(function (nestedKey) {\n                if (![\"all\", \"any\", \"none\"].includes(nestedKey)) {\n                  acc.add(nestedKey);\n                } else {\n                  acc = new Set([].concat(toConsumableArray(acc), toConsumableArray(_this.getListOfAppliedFilters(nestedValue))));\n                }\n              });\n            });\n          }\n          return acc;\n        }, new Set());\n\n        return Array.from(set$$1.values());\n      }\n    }]);\n    return Filters;\n  }();\n\n  var version = \"7.7.0\";\n\n  var QueryCache = function () {\n    function QueryCache() {\n      classCallCheck(this, QueryCache);\n\n      this.cache = {};\n    }\n\n    createClass(QueryCache, [{\n      key: \"getKey\",\n      value: function getKey(method, url, params) {\n        return method + url + JSON.stringify(params);\n      }\n    }, {\n      key: \"store\",\n      value: function store(key, response) {\n        this.cache[key] = response;\n      }\n    }, {\n      key: \"retrieve\",\n      value: function retrieve(key) {\n        return this.cache[key];\n      }\n    }]);\n    return QueryCache;\n  }();\n\n  var cache = new QueryCache();\n\n  function request(searchKey, apiEndpoint, path, params, cacheResponses) {\n    var _ref = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {},\n        additionalHeaders = _ref.additionalHeaders;\n\n    var method = \"POST\";\n    var key = cache.getKey(method, apiEndpoint + path, params);\n    if (cacheResponses) {\n      var cachedResult = cache.retrieve(key);\n      if (cachedResult) {\n        return Promise.resolve(cachedResult);\n      }\n    }\n\n    return _request(method, searchKey, apiEndpoint, path, params, {\n      additionalHeaders: additionalHeaders\n    }).then(function (response) {\n      return response.json().then(function (json) {\n        var result = { response: response, json: json };\n        if (cacheResponses) cache.store(key, result);\n        return result;\n      }).catch(function () {\n        return { response: response, json: {} };\n      });\n    });\n  }\n\n  function _request(method, searchKey, apiEndpoint, path, params) {\n    var _ref2 = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {},\n        additionalHeaders = _ref2.additionalHeaders;\n\n    var headers = new Headers(_extends({\n      Authorization: \"Bearer \" + searchKey,\n      \"Content-Type\": \"application/json\",\n      \"X-Swiftype-Client\": \"elastic-app-search-javascript\",\n      \"X-Swiftype-Client-Version\": version\n    }, additionalHeaders));\n\n    return fetch(\"\" + apiEndpoint + path, {\n      method: method,\n      headers: headers,\n      body: JSON.stringify(params),\n      credentials: \"include\"\n    });\n  }\n\n  var SEARCH_TYPES = {\n    SEARCH: \"SEARCH\",\n    MULTI_SEARCH: \"MULTI_SEARCH\"\n  };\n\n  /**\n   * Omit a single key from an object\n   */\n  function omit(obj, keyToOmit) {\n    if (!obj) return;\n    var _ = obj[keyToOmit],\n        rest = objectWithoutProperties(obj, [keyToOmit]);\n\n    return rest;\n  }\n\n  function flatten(arrayOfArrays) {\n    return [].concat.apply([], arrayOfArrays);\n  }\n\n  function formatResultsJSON(json) {\n    return new ResultList(json.results, omit(json, \"results\"));\n  }\n\n  function handleErrorResponse(_ref) {\n    var response = _ref.response,\n        json = _ref.json;\n\n    if (!response.ok) {\n      var message = Array.isArray(json) ? \" \" + flatten(json.map(function (response) {\n        return response.errors;\n      })).join(\", \") : \"\" + (json.errors ? \" \" + json.errors : \"\");\n      throw new Error(\"[\" + response.status + \"]\" + message);\n    }\n    return json;\n  }\n\n  var Client = function () {\n    function Client(hostIdentifier, searchKey, engineName) {\n      var _ref2 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {},\n          _ref2$endpointBase = _ref2.endpointBase,\n          endpointBase = _ref2$endpointBase === undefined ? \"\" : _ref2$endpointBase,\n          _ref2$cacheResponses = _ref2.cacheResponses,\n          cacheResponses = _ref2$cacheResponses === undefined ? true : _ref2$cacheResponses,\n          additionalHeaders = _ref2.additionalHeaders;\n\n      classCallCheck(this, Client);\n\n      this.additionalHeaders = additionalHeaders;\n      this.searchKey = searchKey;\n      this.cacheResponses = cacheResponses;\n      this.engineName = engineName;\n      this.apiEndpoint = endpointBase ? endpointBase + \"/api/as/v1/\" : \"https://\" + hostIdentifier + \".api.swiftype.com/api/as/v1/\";\n      this.searchPath = \"engines/\" + this.engineName + \"/search\";\n      this.multiSearchPath = \"engines/\" + this.engineName + \"/multi_search\";\n      this.querySuggestionPath = \"engines/\" + this.engineName + \"/query_suggestion\";\n      this.clickPath = \"engines/\" + this.engineName + \"/click\";\n    }\n\n    /**\n     * Sends a query suggestion request to the Elastic App Search Api\n     *\n     * @param {String} query String that is used to perform a query suggest.\n     * @param {Object} options Object used for configuring the query suggest, like 'types' or 'size'\n     * @returns {Promise<ResultList>} a Promise that returns results, otherwise throws an Error.\n     */\n\n\n    createClass(Client, [{\n      key: \"querySuggestion\",\n      value: function querySuggestion(query) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n        var params = Object.assign({ query: query }, options);\n\n        return request(this.searchKey, this.apiEndpoint, this.querySuggestionPath, params, this.cacheResponses, { additionalHeaders: this.additionalHeaders }).then(handleErrorResponse);\n      }\n\n      /**\n       * Sends a search request to the Elastic App Search Api\n       *\n       * @param {String} query String, Query, or Object that is used to perform a search request.\n       * @param {Object} options Object used for configuring the search like search_fields and result_fields\n       * @returns {Promise<ResultList>} a Promise that returns a {ResultList} when resolved, otherwise throws an Error.\n       */\n\n    }, {\n      key: \"search\",\n      value: function search(query) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var disjunctiveFacets = options.disjunctiveFacets,\n            disjunctiveFacetsAnalyticsTags = options.disjunctiveFacetsAnalyticsTags,\n            validOptions = objectWithoutProperties(options, [\"disjunctiveFacets\", \"disjunctiveFacetsAnalyticsTags\"]);\n\n\n        var params = Object.assign({ query: query }, validOptions);\n\n        if (disjunctiveFacets && disjunctiveFacets.length > 0) {\n          return this._performDisjunctiveSearch(params, disjunctiveFacets, disjunctiveFacetsAnalyticsTags).then(formatResultsJSON);\n        }\n        return this._performSearch(params).then(formatResultsJSON);\n      }\n\n      /**\n       * Sends multiple search requests to the Elastic App Search Api, using the\n       * \"multi_search\" endpoint\n       *\n       * @param {Array[Object]} searches searches to send, valid keys are:\n       * - query: String\n       * - options: Object (optional)\n       * @returns {Promise<[ResultList]>} a Promise that returns an array of {ResultList} when resolved, otherwise throws an Error.\n       */\n\n    }, {\n      key: \"multiSearch\",\n      value: function multiSearch(searches) {\n        var params = searches.map(function (search) {\n          return _extends({\n            query: search.query\n          }, search.options || {});\n        });\n\n        return this._performSearch({ queries: params }, SEARCH_TYPES.MULTI_SEARCH).then(function (responses) {\n          return responses.map(formatResultsJSON);\n        });\n      }\n\n      /*\n       * A disjunctive search, as opposed to a regular search is used any time\n       * a `disjunctiveFacet` option is provided to the `search` method. A\n       * a disjunctive facet requires multiple API calls.\n       *\n       * Typically:\n       *\n       * 1 API call to get the base results\n       * 1 additional API call to get the \"disjunctive\" facet counts for each\n       * facet configured as \"disjunctive\".\n       *\n       * The additional API calls are required, because a \"disjunctive\" facet\n       * is one where we want the counts for a facet as if there is no filter applied\n       * to a particular field.\n       *\n       * After all queries are performed, we merge the facet values on the\n       * additional requests into the facet values of the original request, thus\n       * creating a single response with the disjunctive facet values.\n       */\n\n    }, {\n      key: \"_performDisjunctiveSearch\",\n      value: function _performDisjunctiveSearch(params, disjunctiveFacets) {\n        var _this = this;\n\n        var disjunctiveFacetsAnalyticsTags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [\"Facet-Only\"];\n\n        var baseQueryPromise = this._performSearch(params);\n\n        var filters = new Filters(params.filters);\n        var appliedFilers = filters.getListOfAppliedFilters();\n        var listOfAppliedDisjunctiveFilters = appliedFilers.filter(function (filter) {\n          return disjunctiveFacets.includes(filter);\n        });\n\n        if (!listOfAppliedDisjunctiveFilters.length) {\n          return baseQueryPromise;\n        }\n\n        var page = params.page || {};\n\n        // We intentionally drop passed analytics tags here so that we don't get\n        // double counted search analytics in the dashboard from disjunctive\n        // calls\n        var analytics = params.analytics || {};\n        analytics.tags = disjunctiveFacetsAnalyticsTags;\n\n        var disjunctiveQueriesPromises = listOfAppliedDisjunctiveFilters.map(function (appliedDisjunctiveFilter) {\n          return _this._performSearch(_extends({}, params, {\n            filters: filters.removeFilter(appliedDisjunctiveFilter).filtersJSON,\n            page: _extends({}, page, {\n              // Set this to 0 for performance, since disjunctive queries\n              // don't need results\n              size: 0\n            }),\n            analytics: analytics,\n            facets: defineProperty({}, appliedDisjunctiveFilter, params.facets[appliedDisjunctiveFilter])\n          }));\n        });\n\n        return Promise.all([baseQueryPromise].concat(toConsumableArray(disjunctiveQueriesPromises))).then(function (_ref3) {\n          var _ref4 = toArray(_ref3),\n              baseQueryResults = _ref4[0],\n              disjunctiveQueries = _ref4.slice(1);\n\n          disjunctiveQueries.forEach(function (disjunctiveQueryResults) {\n            var _Object$entries$ = slicedToArray(Object.entries(disjunctiveQueryResults.facets)[0], 2),\n                facetName = _Object$entries$[0],\n                facetValue = _Object$entries$[1];\n\n            baseQueryResults.facets[facetName] = facetValue;\n          });\n          return baseQueryResults;\n        });\n      }\n    }, {\n      key: \"_performSearch\",\n      value: function _performSearch(params) {\n        var searchType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : SEARCH_TYPES.SEARCH;\n\n        var searchPath = searchType === SEARCH_TYPES.MULTI_SEARCH ? this.multiSearchPath : this.searchPath;\n        return request(this.searchKey, this.apiEndpoint, searchPath + \".json\", params, this.cacheResponses, { additionalHeaders: this.additionalHeaders }).then(handleErrorResponse);\n      }\n\n      /**\n       * Sends a click event to the Elastic App Search Api, to track a click-through event\n       *\n       * @param {String} query Query that was used to perform the search request\n       * @param {String} documentId ID of the document that was clicked\n       * @param {String} requestId Request_id from search response\n       * @param {String[]} tags Tags to categorize this request in the Dashboard\n       * @returns {Promise} An empty Promise, otherwise throws an Error.\n       */\n\n    }, {\n      key: \"click\",\n      value: function click(_ref5) {\n        var query = _ref5.query,\n            documentId = _ref5.documentId,\n            requestId = _ref5.requestId,\n            _ref5$tags = _ref5.tags,\n            tags = _ref5$tags === undefined ? [] : _ref5$tags;\n\n        var params = {\n          query: query,\n          document_id: documentId,\n          request_id: requestId,\n          tags: tags\n        };\n\n        return request(this.searchKey, this.apiEndpoint, this.clickPath + \".json\", params, this.cacheResponses, { additionalHeaders: this.additionalHeaders }).then(handleErrorResponse);\n      }\n    }]);\n    return Client;\n  }();\n\n  function createClient(_ref) {\n    var hostIdentifier = _ref.hostIdentifier,\n        accountHostKey = _ref.accountHostKey,\n        apiKey = _ref.apiKey,\n        searchKey = _ref.searchKey,\n        engineName = _ref.engineName,\n        endpointBase = _ref.endpointBase,\n        cacheResponses = _ref.cacheResponses,\n        additionalHeaders = _ref.additionalHeaders;\n\n    hostIdentifier = hostIdentifier || accountHostKey; // accountHostKey is deprecated\n    searchKey = searchKey || apiKey; //apiKey is deprecated\n    return new Client(hostIdentifier, searchKey, engineName, {\n      endpointBase: endpointBase,\n      cacheResponses: cacheResponses,\n      additionalHeaders: additionalHeaders\n    });\n  }\n\n  exports.createClient = createClient;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n"]},"metadata":{},"sourceType":"script"}